// file: prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Property {
  id                   Int      @id @default(autoincrement())
  name                 String
  base_price_per_night Decimal  @db.Decimal(12, 2)
  pricingRules         PricingRule[]
  priceOverrides       PriceOverride[]
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
}

model PricingRule {
  id            Int      @id @default(autoincrement())
  propertyId    Int
  name          String
  start_date    DateTime @db.Date
  end_date      DateTime @db.Date
  min_price     Decimal  @db.Decimal(12, 2)
  max_price     Decimal  @db.Decimal(12, 2)
  default_price Decimal  @db.Decimal(12, 2)
  property      Property @relation(fields: [propertyId], references: [id])
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model PriceOverride {
  id            Int      @id @default(autoincrement())
  propertyId    Int
  override_date DateTime @db.Date
  price         Decimal  @db.Decimal(12, 2)
  property      Property @relation(fields: [propertyId], references: [id])
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  @@unique([propertyId, override_date])
}
